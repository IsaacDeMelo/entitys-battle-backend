<!DOCTYPE html>
<html>
<head>
    <title>Admin Lab</title>
    <style>
        body { background: #222; color: #fff; font-family: monospace; padding: 20px; }
        .container { display: flex; gap: 20px; }
        .form-col { flex: 1; background: #333; padding: 20px; border-radius: 10px; }
        .list-col { flex: 1; height: 90vh; overflow-y: auto; }
        input, select, textarea { width: 100%; padding: 8px; margin-bottom: 10px; background: #111; color: white; border: 1px solid #555; }
        button { padding: 10px 20px; background: #2ecc71; color: white; border: none; cursor: pointer; }
        .poke-item { background: #444; padding: 10px; margin-bottom: 5px; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .poke-item img { width: 30px; height: 30px; }
    </style>
</head>
<body>
    <h1>LABORATÓRIO GENÉTICO</h1>
    <a href="/" style="color:#3498db">Voltar ao Jogo</a>
    <div class="container">
        <div class="form-col">
            <h3>Criar / Editar Pokémon</h3>
            <form action="/lab/create" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="existingId" id="existingId">
                <label>Nome</label><input type="text" name="name" id="pName" required>
                <label>Tipo</label><select name="type" id="pType"><% for(let t in types) { %><option value="<%= types[t] %>"><%= types[t] %></option><% } %></select>
                <div style="display:flex; gap:5px;"><input type="number" name="hp" id="pHp" placeholder="HP Base" value="50"><input type="number" name="energy" id="pEn" placeholder="Energy" value="100"></div>
                <div style="display:flex; gap:5px;"><input type="number" name="atk" id="pAtk" placeholder="ATK" value="10"><input type="number" name="def" id="pDef" placeholder="DEF" value="10"><input type="number" name="spd" id="pSpd" placeholder="SPD" value="10"></div>
                <label>Spawn Location</label><select name="location" id="pLoc"><option value="none">Nenhum</option><option value="forest">Floresta</option></select>
                <div style="display:flex; gap:5px;"><input type="number" name="minLvl" id="pMin" placeholder="Min Lvl" value="1"><input type="number" name="maxLvl" id="pMax" placeholder="Max Lvl" value="5"></div>
                <label>Catch Rate (0.1 a 1.0)</label><input type="number" step="0.1" name="catchRate" id="pRate" value="0.5">
                <label>Sprite (PNG/GIF)</label><input type="file" name="sprite">
                <label>Evolução (ID do Alvo)</label><input type="text" name="evoTarget" id="pEvoT"><input type="number" name="evoLevel" id="pEvoL" placeholder="Nível Evolução">
                <label>Moves Pool (JSON)</label><textarea name="movesJson" id="pMoves" rows="5">[{"level":1,"moveId":"tackle"}]</textarea>
                <button type="submit">SALVAR DADOS</button>
            </form>
        </div>
        <div class="list-col">
            <h3>Banco de Dados</h3>
            <% pokemons.forEach(p => { %>
                <div class="poke-item" onclick='loadData(<%- JSON.stringify(p) %>)'><% if(p.sprite) { %><img src="/uploads/<%= p.sprite %>"><% } %><strong><%= p.name %></strong> (ID: <%= p.id %>)</div>
            <% }) %>
        </div>
    </div>
    <script>
        function loadData(p) {
            document.getElementById('existingId').value = p.id; document.getElementById('pName').value = p.name; document.getElementById('pType').value = p.type;
            document.getElementById('pHp').value = p.baseStats.hp; document.getElementById('pEn').value = p.baseStats.energy;
            document.getElementById('pAtk').value = p.baseStats.attack; document.getElementById('pDef').value = p.baseStats.defense; document.getElementById('pSpd').value = p.baseStats.speed;
            document.getElementById('pLoc').value = p.spawnLocation || 'none'; document.getElementById('pMin').value = p.minSpawnLevel || 1; document.getElementById('pMax').value = p.maxSpawnLevel || 5;
            document.getElementById('pRate').value = p.catchRate || 0.5;
            if(p.evolution) { document.getElementById('pEvoT').value = p.evolution.targetId || ''; document.getElementById('pEvoL').value = p.evolution.level || ''; }
            document.getElementById('pMoves').value = JSON.stringify(p.movePool || []);
        }
    </script>
</body>
</html>