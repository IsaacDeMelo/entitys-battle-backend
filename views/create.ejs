<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratório (Admin)</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: #222; padding: 20px; border-radius: 10px; }
        h1, h2, h3 { color: #f1c40f; text-align: center; }
        label { display: block; margin-top: 10px; color: #ccc; }
        input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; background: #000; border: 1px solid #555; color: white; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; margin-top: 15px; background: #3498db; border: none; color: white; font-weight: bold; cursor: pointer; border-radius: 5px; }
        .tab-nav { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .tab-btn { flex: 1; padding: 10px; background: #333; border: none; color: #aaa; cursor: pointer; }
        .tab-btn.active { background: #f1c40f; color: #000; font-weight: bold; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="container">
        <h1>LABORATÓRIO</h1>
        <a href="/" style="color:#aaa; text-decoration:none;">&larr; Voltar</a>

        <div class="tab-nav">
            <button class="tab-btn active" onclick="openTab('tab-poke')">CRIAR POKEMON</button>
            <button class="tab-btn" onclick="openTab('tab-npc')">CRIAR NPC</button>
        </div>

        <!-- TAB POKEMON -->
        <div id="tab-poke" class="tab-content active">
            <form action="/lab/create" method="POST" enctype="multipart/form-data">
                <label>ID Existente (para editar):</label>
                <input type="text" name="existingId" placeholder="Deixe vazio para criar novo">

                <label>Nome:</label>
                <input type="text" name="name" required>

                <label>Tipo:</label>
                <select name="type">
                    <% Object.keys(types).forEach(t => { %>
                        <option value="<%= t %>"><%= t.toUpperCase() %></option>
                    <% }) %>
                </select>

                <h3>Status Base</h3>
                <div style="display:flex; gap:5px;">
                    <input type="number" name="hp" placeholder="HP" required>
                    <input type="number" name="energy" placeholder="EN" required>
                    <input type="number" name="atk" placeholder="ATK" required>
                </div>
                <div style="display:flex; gap:5px;">
                    <input type="number" name="def" placeholder="DEF" required>
                    <input type="number" name="spd" placeholder="SPD" required>
                </div>

                <h3>Spawn & Info</h3>
                <label>Local:</label>
                <select name="location">
                    <option value="none">Nenhum</option>
                    <option value="forest">Floresta</option>
                </select>

                <div style="display:flex; gap:5px;">
                    <input type="number" name="minLvl" placeholder="Min Lvl" value="1">
                    <input type="number" name="maxLvl" placeholder="Max Lvl" value="5">
                </div>
                
                <div style="display:flex; gap:5px;">
                    <input type="number" step="0.1" name="catchRate" placeholder="Catch Rate (0-1)" value="0.5">
                    <input type="number" name="spawnChance" placeholder="Spawn Weight" value="10">
                </div>

                <label><input type="checkbox" name="isStarter" style="width:auto;"> É Inicial?</label>

                <h3>Golpes (JSON)</h3>
                <textarea name="movesJson" placeholder='[{"level":1, "moveId":"tackle"}]' rows="4"></textarea>
                <small>Moves: <%= Object.keys(moves).join(', ') %></small>

                <h3>Evolução</h3>
                <div style="display:flex; gap:5px;">
                    <input type="text" name="evoTarget" placeholder="ID do Alvo">
                    <input type="number" name="evoLevel" placeholder="Nível">
                </div>

                <h3>Sprite</h3>
                <input type="file" name="sprite" accept="image/*">

                <button type="submit">SALVAR MONSTRO</button>
            </form>
        </div>

        <!-- TAB NPC -->
        <div id="tab-npc" class="tab-content">
            <form action="/lab/create-npc" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="userId" value="<%= user._id %>">
                
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <div><label>Nome</label><input type="text" name="name" required></div>
                    <div>
                        <label>Mapa</label>
                        <select name="map">
                            <option value="lobby">Cidade (Lobby)</option>
                            <option value="forest">Floresta</option>
                        </select>
                    </div>
                    <div><label>Pos X (%)</label><input type="number" name="x" value="50"></div>
                    <div><label>Pos Y (%)</label><input type="number" name="y" value="50"></div>
                    <div>
                        <label>Direção</label>
                        <select name="direction">
                            <option value="down">Baixo</option>
                            <option value="up">Cima</option>
                            <option value="left">Esquerda</option>
                            <option value="right">Direita</option>
                        </select>
                    </div>
                    <div><label>Recompensa ($)</label><input type="number" name="money" value="100"></div>
                </div>
        
                <label>Skin Padrão:</label>
                <select name="skinSelect">
                    <option value="char1">Char 1</option>
                    <option value="char2">Char 2</option>
                    <option value="char3">Char 3</option>
                    <option value="char4">Char 4</option>
                    <option value="char5">Char 5</option>
                    <option value="char6">Char 6</option>
                </select>
                <label>OU Upload Customizado:</label>
                <input type="file" name="npcSkinFile" accept="image/*">
        
                <label>Diálogo:</label>
                <input type="text" name="dialogue" placeholder="Ex: Vamos batalhar!">
        
                <label>Time Pokémon (JSON):</label>
                <textarea name="teamJson" rows="3" style="font-family:monospace; color:#0f0;">[{"baseId":"charmander", "level":5}]</textarea>
                <small>IDs: <%= pokemons.map(p=>p.id).join(', ') %></small>
        
                <button type="submit" style="background:#e67e22;">CRIAR NPC</button>
            </form>
        </div>

    </div>

    <script>
        function openTab(id) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
